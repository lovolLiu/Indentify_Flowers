
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Identify Flowers For You </title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Free HTML5 Template by FREEHTML5.CO" />
    <meta name="keywords" content="free html5, free template, free bootstrap, html5, css3, mobile first, responsive" />
    <meta name="author" content="FREEHTML5.CO" />

    <!-- Facebook and Twitter integration -->
    <meta property="og:title" content=""/>
    <meta property="og:image" content=""/>
    <meta property="og:url" content=""/>
    <meta property="og:site_name" content=""/>
    <meta property="og:description" content=""/>
    <meta name="twitter:title" content="" />
    <meta name="twitter:image" content="" />
    <meta name="twitter:url" content="" />
    <meta name="twitter:card" content="" />

    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <link rel="shortcut icon" href="favicon.ico">
    <!-- Animate -->
    <link rel="stylesheet" href="static/css/animate.css">
    <!-- Flexslider -->
    <link rel="stylesheet" href="static/css/flexslider.css">
    <!-- Icomoon -->
    <link rel="stylesheet" href="static/css/icomoon.css">
    <!-- Bootstrap  -->
    <link rel="stylesheet" href="static/css/bootstrap.css">
    <link rel="stylesheet" href="static/css/dropify.css">
    <link rel="stylesheet" href="static/css/style.css">
    <link rel="stylesheet" href="static/css/owl.theme.default.min.css">
    <link rel="stylesheet" href="static/css/owl.carousel.min.css">
    <!-- Modernizr JS -->
    <script src="static/js/modernizr-2.6.2.min.js"></script>
    <!-- FOR IE9 below -->
    <!--[if lt IE 9]>
    <script src="js/respond.min.js"></script>
    <![endif]-->
    <style>
		.upload{
		    background-image:url('static/images/upload_bkg.jpg');
		    background-size:cover;
		}
		.fh5co-spacer-xs {
            height: 30px;
        }
        .fh5co-spacer {
            clear: both;
            position: relative;
            border: none;
            padding: 0;
            margin: 0;
        }
        .fh5co-uppercase-heading-sm {
            font-size: 14px;
            line-height: 26px;
            text-transform: uppercase;
            letter-spacing: 3px;
            color: #ccc;
        }
        .quote {
            width: 80%;
            margin: 0 auto;
            font-size: large;
            font-weight: 300;
            line-height: 38px;
            color: #fff;
        }
        .text-center {
            text-align: center;
        }
        .quote cite {
            margin-top: 20px;
            display: block;
            font-size: 20px;
            font-style: normal;
            text-align:center;
        }
        .fh5co-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: .7;
            background: #444853;
        }
        .detail-area{
            background-image:url(static/images/slide_3.jpg);
            background-size:cover;
            position:relative;
        }
        .loader,
        .loader:before,
        .loader:after {
            background: #e48bb0;
            -webkit-animation: load1 1s infinite ease-in-out;
            animation: load1 1s infinite ease-in-out;
            width: 1em;
            height: 4em;
        }
        .loader {
          color: #e48bb0;
          text-indent: -9999em;
          margin: 88px auto;
          position: relative;
          font-size: 11px;
          -webkit-transform: translateZ(0);
          -ms-transform: translateZ(0);
          transform: translateZ(0);
          -webkit-animation-delay: -0.16s;
          animation-delay: -0.16s;
        }
        .loader:before,
        .loader:after {
          position: absolute;
          top: 0;
          content: '';
        }
        .loader:before {
          left: -1.5em;
          -webkit-animation-delay: -0.32s;
          animation-delay: -0.32s;
        }
        .loader:after {
          left: 1.5em;
        }
        @-webkit-keyframes load1 {
          0%,
          80%,
          100% {
            box-shadow: 0 0;
            height: 4em;
          }
          40% {
            box-shadow: 0 -2em;
            height: 5em;
          }
        }
        @keyframes load1 {
          0%,
          80%,
          100% {
            box-shadow: 0 0;
            height: 4em;
          }
          40% {
            box-shadow: 0 -2em;
            height: 5em;
          }
        }
    </style>
</head>
<body>
<div id="fh5co-header">
    <div class="container">
        <!-- Mobile Toggle Menu Button -->
        <a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>
        <div id="fh5co-logo">
            <a href="index.html">flowergrafy<span>.</span></a>
        </div>
    </div>
</div>
<div id="fh5co-main">
    <div class="fh5co-overlay-mobile"></div>
    <div id="fh5co-home" class="js-fullheight" data-section="home">

        <div class="flexslider">

            <div class="fh5co-overlay"></div>
            <div class="fh5co-text">
                <div class="container">
                    <div class="row text-center">
                        <h1 class="animate-box">A flower is a world</h1>
                        <div class="fh5co-go animate-box">
                            <a href="#" class="js-fh5co-next">
                                Identify Flowers
                                <span><i class="icon-arrow-down2"></i></span>
                            </a>

                        </div>
                    </div>
                </div>
            </div>
            <ul class="slides">
                <li style="background-image: url(static/images/slide_2.jpg);" data-stellar-background-ratio="0.5"></li>
                <li style="background-image: url(static/images/slide_1.jpg);" data-stellar-background-ratio="0.5"></li>
                <li style="background-image: url(static/images/slide_3.jpg);" data-stellar-background-ratio="0.5"></li>
            </ul>

        </div>
    </div>
    <div id="uploadArea">
        <div class="row r-pb upload">
            <div class="fh5co-overlay" style="opacity: 0.5;"></div>
            <div class="col-sm-8 col-md-8 col-sm-offset-2 col-md-offset-2 text-center">
                <h2 class="fh5co-section-title animate-box fadeInUp animated" style="padding:2.5em;color:#d87894;">请上传您要识别的图片</h2>
                <form id="upload_form">
                    <input id="uploaded_file" name="file" type="file" class="dropify" data-height="500" />
                </form>
            </div>
            <div class="fh5co-spacer fh5co-spacer-xs"></div>
            <div class="fh5co-spacer fh5co-spacer-xs"></div>
            <div class="fh5co-spacer fh5co-spacer-xs"></div>
            <div class="fh5co-spacer fh5co-spacer-xs"></div>
        </div>
    </div>
    <div id="loadingArea" style="display:none;">
        <div class="loader" style="margin-top:200px;">
            Loading...
        </div>
        <p style="text-align:center;margin-bottom:200px;font-size: x-large;">正在识别花朵，请稍后...</p>
    </div>
    <div id="resultArea" style="display:none;" data-section="portfolio">
        <div class="container">
            <div class="row">
                <div class="col-md-8 col-md-offset-2 text-center section-heading" style="margin-top: 30px;">
                    <p class="fh5co-lead animate-box fadeInUp animated" style="color:#d87894;">- 您上传的图片为 -</p>
                </div>
            </div>
            <div align="center">
                <img id="user_uploaded_img" src=""/>
            </div>
            <div class="col-md-8 col-md-offset-2 text-center section-heading" style="margin-top: 30px;">
                <p class="fh5co-lead animate-box fadeInUp animated" style="color:#d87894;">- 识别出的图片为 -</p>
            </div>
            <div class="row">
                <div class="col-md-4 col-sm-4 col-xs-6 col-xxs-12 animate-box fadeInUp animated">
                    <div class="img-grid">
                        <img id="first_match_img" src="" class="img-responsive">
                        <a class="flower_detail">
                            <div>
                                <span class="fh5co-meta" id="first_match_n"></span>
                                <h2 class="fh5co-title" id="first_match_p"></h2>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="col-md-4 col-sm-4 col-xs-6 col-xxs-12 animate-box fadeInUp animated">
                    <div class="img-grid">
                        <img id="second_match_img" src="" class="img-responsive">
                        <a class="flower_detail">
                            <div>
                                <span class="fh5co-meta" id="second_match_n"></span>
                                <h2 class="fh5co-title" id="second_match_p"></h2>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="col-md-4 col-sm-4 col-xs-6 col-xxs-12 animate-box fadeInUp animated">
                    <div class="img-grid">
                        <img id="third_match_img" src="" class="img-responsive">
                        <a class="flower_detail">
                            <div>
                                <span class="fh5co-meta" id="third_match_n"></span>
                                <h2 class="fh5co-title" id="third_match_p"></h2>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="col-md-4 col-sm-4 col-xs-6 col-xxs-12 animate-box fadeInUp animated">
                    <div class="img-grid">
                        <img id="fourth_match_img" src="" class="img-responsive">
                        <a class="flower_detail">
                            <div>
                                <span class="fh5co-meta" id="fourth_match_n"></span>
                                <h2 class="fh5co-title" id="fourth_match_p"></h2>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="col-md-4 col-sm-4 col-xs-6 col-xxs-12 animate-box fadeInUp animated">
                    <div class="img-grid">
                        <img id="fifth_match_img" src="" class="img-responsive">
                        <a class="flower_detail">
                            <div>
                                <span class="fh5co-meta" id="fifth_match_n"></span>
                                <h2 class="fh5co-title" id="fifth_match_p"></h2>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="col-md-4 col-sm-4 col-xs-6 col-xxs-12 animate-box fadeInUp animated">
                    <div class="img-grid">
                        <img id="sixth_match_img" src="static/images/flowers/百合.jpg" class="img-responsive">
                        <a class="flower_detail">
                            <div>
                                <span class="fh5co-meta" id="sixth_match_n">百合</span>
                                <h2 class="fh5co-title" id="sixth_match_p"></h2>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="row r-pb">
                    <div class="col-md-8 col-md-offset-2 text-center section-heading">
                        <p class="fh5co-lead animate-box fadeInUp animated">                                          </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="detailArea" class="row detail-area">
        <div class="fh5co-overlay"></div>
        <!-- Start Slider Testimonial -->
        <h2 id="detail-header" class="fh5co-uppercase-heading-sm text-center animate-box"></h2>
        <div class="fh5co-spacer fh5co-spacer-xs"></div>
        <div class="owl-carousel-fullwidth">
            <div class="item">
                <p class="quote flower-medical">
                </p>
            </div>
            <div class="item">
                <p class="quote flower-lan" style="text-align:center;">
                </p>
            </div>
            <div class="item">
                <p class="quote flower-intro">
                </p>
            </div>
        </div>
        <!-- End Slider Testimonial -->
        <a class="btn btn-primary col-md-2 col-md-offset-5 col-sm-4 col-sm-offset-4 col-xs-8 col-xs-offset-2" onclick="showUpload()">重新上传图片</a>
    </div>
    <!-- END row -->
</div>

<div id="fh5co-footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 animate-box">
                <div class="fh5co-footer-widget">
                    <p>Created by Xintong Liu</p>
                    <p>Beijing University of Posts and Telecommunications</p>
                </div>
            </div>
            <div class="col-md-6 col-sm-6 animate-box">
                <div class="fh5co-footer-widget">
                    <ul class="fh5co-social pull-right">
                        <li>
                            <a href="#"><i class="icon-twitter"></i></a>
                        </li>
                        <li>
                            <a href="#"><i class="icon-facebook"></i></a>
                        </li>
                        <li>
                            <a href="#"><i class="icon-vine"></i></a>
                        </li>
                        <li>
                            <a href="#"><i class="icon-behance"></i></a>
                        </li>
                        <li>
                            <a href="#"><i class="icon-google"></i></a>
                        </li>
                        <li>
                            <a href="#"><i class="icon-vimeo"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- END fh5co-page -->



<!-- jQuery -->
<script src="static/js/jquery.min.js"></script>
<!-- jQuery Easing -->
<script src="static/js/jquery.easing.1.3.js"></script>
<!-- Bootstrap -->
<script src="static/js/bootstrap.min.js"></script>
<!-- Waypoints -->
<script src="static/js/jquery.waypoints.min.js"></script>
<!-- Stellar Parallax -->
<script src="static/js/jquery.stellar.min.js"></script>
<!-- Flexslider -->
<script src="static/js/jquery.flexslider-min.js"></script>
<!-- Main JS -->
<script src="static/js/main.js"></script>
<!-- Dropify -->
<script src="static/js/dropify.js"></script>
<script src="static/js/owl.carousel.min.js"></script>
<script>
        function showResult(){
            $('#loadingArea').attr('style', 'display:none')
            $('#resultArea').attr('style', '')
            $('#detailArea').css('visibility', 'visible')
        }
        function showUpload(){
            $('#uploadArea').attr('style','')
            $('#resultArea').attr('style','display:none;')
            $('#detailArea').css('visibility', 'hidden')
            window.location.href = "#uploadArea"
        }
        $('.flower_detail').click(function(){
            flower_name = $(this).find('div').find('span').html()
            var data = {}
            data['flower_name'] = flower_name
            $.ajax({
                type: 'POST',
                url: '/detail',
                data: JSON.stringify(data),
                contentType: 'application/json; charset=UTF-8',
                dataType: 'json',
                success: function(data) {
                    $('#detail-header').html("详情-" + data.flower_name)
                    $('.flower-intro').html("<cite class='author'>简介</cite>" + data.flower_intro)
                    $('.flower-lan').html("<cite class='author'>花语</cite>" + data.flower_lan)
                    $('.flower-medical').html("<cite class='author'>药用价值</cite>" + data.flower_medical)
                    $('.owl-dot').click()
                    window.location.href = "#detailArea"
                    console.log(data)
                },
                error: function(xhr, type) {
                }
            });
        })
        $(document).ready(function(){
            var drEvent = $('.dropify').dropify();
            // Owl Carousel
            var owlCrouselFeatureSlide = function() {
                var owl = $('.owl-carousel');
                owl.owlCarousel({
                    items: 1,
                    loop: true,
                    margin: 0,
                    responsiveClass: true,
                    nav: true,
                    dots: true,
                    smartSpeed: 500,
                    navText: [
                      "<i class='ti-arrow-left owl-direction'></i>",
                      "<i class='ti-arrow-right owl-direction'></i>"
                    ]
                });
            };
            var testimonialCarousel = function(){
                var owl = $('.owl-carousel-fullwidth');
                owl.owlCarousel({
                    items: 1,
                    loop: true,
                    margin: 0,
                    responsiveClass: true,
                    nav: false,
                    dots: true,
                    smartSpeed: 500,
                    autoHeight: true
                });
            };
            testimonialCarousel();
            $('#detailArea').css('visibility', 'hidden')
            drEvent.on('dropify.fileReady', function(event, element){
                var fd = new FormData();
                fd.append('file', $(':file')[0].files[0]);
                $('#uploadArea').attr('style', 'display:none;')
                $('#loadingArea').attr('style', '')
                $.ajax({
                    url: '/upload',
                    type: 'POST',
                    data: fd,
                    contentType:false,  //必须false才会自动加上正确的Content-Type
                    processData:false //必须false才会避开jQuery对 formdata 的默认处理
                }).done(function(result){
                    if(result.status == "ok"){
                        //do something to show result
                        $('#user_uploaded_img').attr('src', result.user_upload)
                        $('#first_match_img').attr('src', 'static/images/flowers/' + result.names[0] + '.jpg')
                        $('#first_match_n').html(result.names[0])
                        $('#first_match_p').html(result.probabilities[0])
                        $('#second_match_img').attr('src', 'static/images/flowers/' + result.names[1] + '.jpg')
                        $('#second_match_n').html(result.names[1])
                        $('#second_match_p').html(result.probabilities[1])
                        $('#third_match_img').attr('src', 'static/images/flowers/' + result.names[2] + '.jpg')
                        $('#third_match_n').html(result.names[2])
                        $('#third_match_p').html(result.probabilities[2])
                        $('#fourth_match_img').attr('src', 'static/images/flowers/' + result.names[3] + '.jpg')
                        $('#fourth_match_n').html(result.names[3])
                        $('#fourth_match_p').html(result.probabilities[3])
                        $('#fifth_match_img').attr('src', 'static/images/flowers/' + result.names[4] + '.jpg')
                        $('#fifth_match_n').html(result.names[4])
                        $('#fifth_match_p').html(result.probabilities[4])
                        showResult()
                    }
                    if(result.status == "fail"){
                        alert("something is wrong")
                    }
                    console.log(result);
                }).fail(function(err){
                    console.log(err);
                });
            });
        });
</script>

</body>
</html>

